# CRM System

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–µ—Ä–≤–∏—Å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏–π (—Ç–∏–∫–µ—Ç–æ–≤) –æ—Ç –ª–∏–¥–æ–≤ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏ —Å —É—á—ë—Ç–æ–º –∏—Ö —Ç–µ–∫—É—â–µ–π –Ω–∞–≥—Ä—É–∑–∫–∏ –∏ –∑–∞–¥–∞–Ω–Ω—ã—Ö –≤–µ—Å–æ–≤.

---

## üìå –ß—Ç–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –Ω–∞–≥—Ä—É–∑–∫–æ–π –Ω–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞

–ù–∞–≥—Ä—É–∑–∫–∞ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ ‚Äî —ç—Ç–æ **–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤**, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã –Ω–∞ –Ω–µ–≥–æ –∏ –µ—â—ë –Ω–µ –∑–∞–∫—Ä—ã—Ç—ã.

- –ê–∫—Ç–∏–≤–Ω—ã–π —Ç–∏–∫–µ—Ç –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å: `status = active`
- –ó–∞–∫—Ä—ã—Ç—ã–π —Ç–∏–∫–µ—Ç –∏–º–µ–µ—Ç —Å—Ç–∞—Ç—É—Å:  `status = closed`

–ö–∞–∂–¥—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä –∏–º–µ–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `max_active_tickets`: –æ–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —Å–∫–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ –æ–ø–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –≤–µ—Å—Ç–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

**–ï—Å–ª–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä –¥–æ—Å—Ç–∏–≥ –ª–∏–º–∏—Ç–∞**, –æ–Ω **–Ω–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏** –Ω–æ–≤–æ–≥–æ —Ç–∏–∫–µ—Ç–∞.

---

## üìå –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ–±—Ä–∞—â–µ–Ω–∏—è

1. –í—Ö–æ–¥—è—â–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–¥–µ—Ä–∂–∞—Ç:
   - email –ª–∏–¥–∞  
   - source_code (–æ—Ç–∫—É–¥–∞ –ø—Ä–∏—à—ë–ª –∑–∞–ø—Ä–æ—Å)  
   - —Ç–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è

2. –õ–∏–¥ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ email:
   - –Ω–∞–π–¥–µ–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –∑–∞–ø–∏—Å—å  
   - –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π

3. –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –∏—Å—Ç–æ—á–Ω–∏–∫ –æ–±—Ä–∞—â–µ–Ω–∏—è (`Source`).

4. –ò–∑ —Ç–∞–±–ª–∏—Ü—ã —Å–≤—è–∑–µ–π –±–µ—Ä—É—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, –Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–µ –Ω–∞ —ç—Ç–æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫.

5. –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤—ã–≤–∞—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ:
   - –∞–∫—Ç–∏–≤–Ω—ã (`is_active = true`)
   - –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∏ –ª–∏–º–∏—Ç–∞ (`—Ç–µ–∫—É—â–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ < max_active_tickets`)

6. **–ï—Å–ª–∏ –Ω–∏ –æ–¥–∏–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç**
   –°–∏—Å—Ç–µ–º–∞ **–Ω–µ –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–∏–∫–µ—Ç**  
   ‚Üí –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ —É—Ä–æ–≤–Ω—è 4xx —Å —Å–æ–æ–±—â–µ–Ω–∏–µ–º:

   > ¬´–í—Å–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã –∑–∞–Ω—è—Ç—ã. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.¬ª

   –¢–∏–∫–µ—Ç –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ **–Ω–µ —Å–æ–∑–¥–∞—ë—Ç—Å—è**, —á—Ç–æ–±—ã –Ω–µ –∫–æ–ø–∏—Ç—å ‚Äú–≤–∏—Å—è—â–∏–µ‚Äù –æ–±—Ä–∞—â–µ–Ω–∏—è –±–µ–∑ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ.

7. **–ï—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã**
   - –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è **–≤–∑–≤–µ—à–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä** –ø–æ –ø–æ–ª—é `weight`
   - —Ç–∏–∫–µ—Ç —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ–º –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞

---

## üìå –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
–ù–∏–∂–µ –æ–ø–∏—Å–∞–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ –∏ –∏—Ö —Å–≤—è–∑–∏.
---

### ### Lead (–ª–∏–¥)

–•—Ä–∞–Ω–∏—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.

| –ü–æ–ª–µ  | –¢–∏–ø     | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|---------|----------|
| id | PK | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| email | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π email –ª–∏–¥–∞ |

–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –ª–∏–¥–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ email.

---

### Operator (–æ–ø–µ—Ä–∞—Ç–æ—Ä)

–ü—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞, –∫–æ—Ç–æ—Ä—ã–π –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| id | PK | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| name | string | –ò–º—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ |
| is_active | bool | –í–∫–ª—é—á—ë–Ω/–≤—ã–∫–ª—é—á–µ–Ω –∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è |
| max_active_tickets | int | –ú–∞–∫—Å–∏–º—É–º –æ—Ç–∫—Ä—ã—Ç—ã—Ö —Ç–∏–∫–µ—Ç–æ–≤ |

–û–ø–µ—Ä–∞—Ç–æ—Ä —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω –∏ –∏–º–µ–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã–π –ª–∏–º–∏—Ç.

---

### Source (–∏—Å—Ç–æ—á–Ω–∏–∫)

–ö–∞–Ω–∞–ª –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –ª–∏–¥–∞ ‚Äî –Ω–∞–ø—Ä–∏–º–µ—Ä, Telegram-–±–æ—Ç.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| id | PK | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| code | string | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –∏–∑–≤–Ω–µ |
| name | string | –ù–∞–∑–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ |

---

### SourceOperatorWeight (–≤–µ—Å–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è)

–ó–∞–¥–∞—ë—Ç —Å–≤—è–∑—å ¬´–∏—Å—Ç–æ—á–Ω–∏–∫ ‚Üí –æ–ø–µ—Ä–∞—Ç–æ—Ä¬ª.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| id | PK | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä |
| source_id | FK ‚Üí sources.id | –ò—Å—Ç–æ—á–Ω–∏–∫ |
| operator_id | FK ‚Üí operators.id | –û–ø–µ—Ä–∞—Ç–æ—Ä |
| weight | int | –í–µ—Å —É—á–∞—Å—Ç–∏—è –≤ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ |

–û–¥–∏–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –≤–µ—Å–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤.

---

### Ticket (–æ–±—Ä–∞—â–µ–Ω–∏–µ)

–ó–∞–ø—Ä–æ—Å, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –ª–∏–¥–æ–º.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|----------|
| id | PK | –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–∏–∫–µ—Ç–∞ |
| lead_id | FK ‚Üí leads.id | –õ–∏–¥ |
| source_id | FK ‚Üí sources.id | –ò—Å—Ç–æ—á–Ω–∏–∫ |
| operator_id | FK ‚Üí operators.id | –ù–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –æ–ø–µ—Ä–∞—Ç–æ—Ä |
| status | enum(active/closed) | –°—Ç–∞—Ç—É—Å |
| message | string (nullable) | –¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è |
| created_at | datetime | –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–Ω —Ç–∏–∫–µ—Ç |
| closed_at | datetime (nullable) | –ö–æ–≥–¥–∞ –∑–∞–∫—Ä—ã—Ç |








